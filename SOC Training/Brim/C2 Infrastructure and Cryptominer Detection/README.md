> /SOCTraining/Zeek/ZeekChallenge

# Brim: Network Analysis and Threat Hunting

## Objectives
The objective of these labs was to practice **network traffic analysis, correlation, and threat hunting** using **Brim**. By investigating provided PCAP files, reviewing generated Zeek logs, running built-in and custom queries, and correlating findings with external tools (e.g., VirusTotal), we explored malicious activity such as **DNS tunneling, phishing, Log4J exploitation, malware C2, and crypto mining**.

## Tools Used
- **Brim** – for log generation, correlation, and timeline-based traffic analysis  
- **Zeek Logs** – auto-generated by Brim from PCAPs (`conn.log`, `dns.log`, `http.log`, etc.)  
- **Suricata Alerts** – correlated within Brim for detection and enrichment  
- **VirusTotal** – to validate suspicious domains, files, and IP addresses  

## Steps Performed
1. **Landing Page & Pools**
   - Imported PCAPs into Brim.  
   - Explored pools, queries, and history panels.  
   - Verified log generation (Zeek logs automatically created from traffic).  

2. **Log Details & Correlation**
   - Investigated capture timelines, connection metadata, and UID references.  
   - Used correlation pane to identify linked logs.
   - Applied options for filtering, sorting, counting, whois lookups, and packet inspection in Wireshark.  

3. **Queries & History**
   - Reviewed default queries (12 pre-made under Brim folder).  
   - Executed and customized queries to analyze DNS, HTTP, file activity, and IP subnet statistics.  

4. **Threat Hunting Scenarios**
   - **Malware C2 Detection (CobaltStrike)**  
     - Identified frequently communicated hosts and abnormal DNS queries.  
     - Validated suspicious IPs and domains with VirusTotal.  
     - Confirmed C2 behavior through Suricata alerts.  
  
   - **Crypto Mining Activity**  
     - Investigated unusual port usage and heavy data transfer.  
     - Correlated Suricata alerts indicating crypto mining.  
     - Enriched findings with VirusTotal and mapped detections to MITRE ATT&CK (T1496 – Resource Hijacking).  

## Key Learnings
- Brim provides an efficient **workflow for analyzing PCAPs** by auto-generating Zeek logs and correlating events in a timeline.  
- The **correlation pane** is valuable for pivoting between related logs and identifying attack flows.  
- Built-in queries and history simplify repetitive analysis and speed up threat hunting.  
- **Suricata alerts** enhance detection coverage and map findings to MITRE ATT&CK techniques.  
- **External enrichment (VirusTotal)** helps validate suspicions and strengthen analysis results.  
- Brim is effective for **traffic-based hunting** against scenarios like **malware C2** and **cryptojacking**, even when logs are limited.  

## Screenshots
Please refer to the attached screenshots in this directory.
 
